<div class="coaching-dashboard">
<h1>Coaching Dashboard</h1>

<% if @activity.any? %>

  <h2>Recent activity by your students that needs your attention</h2>

  <ol>
  <% @activity.each do |task| %>
    <li><a href="#"><%= task.user.name %></a> <span class="task-action"><%= task.pending_approval? ? "submitted" : "commented upon" %></span> <span class="task-name"><%= task.task_definition.name.html_safe %></span>
    <% if task.files.any? %>
    by uploading
      <a href="<%= task.files.first.url %>"><%= task.files.first["#{task.file_type}_file_name"] %></a>
    <% end %>
    at
      <%= task.updated_at.strftime("%B %d, %Y") %>

      <div class="comments-holder">
        <% task.comments.each do |comment| %>
          <%= render :partial => "comments/comment", locals: { :comment => comment } %>
        <% end %>
      </div>
      <%= render partial: "comments/form", locals: { :task => task } %>

      <% if task.pending_approval? %>
        <div>
          <button class="approve-task" type="button" data-task-id="<%= task.id %>">Approve</button>
          <button class="request-task-revisions" type="button" data-task-id="<%= task.id %>">Request Revisions</button>
        </div>
      <%end%>
    </li>
  <% end %>
  </ol>

<% end %>

<h2>Student List</h2>
<p>Here's the list of students you are coaching. Click on a name to see their progress.</p>

<ul>
<% @students.each do |student| %>
  <li><a href="/assignments?student=<%=student.id%>"><%= student.name %> &lt;<%= student.email %>&gt;</a></li>
<% end %>
</ul>
</div>
