<div id="task-update-student" class="container-fluid">
  <%= form_for [task.assignment, task], role: 'form' do |f| %>

    <%= render "shared/form_errors", locals: { object: task } %>

    <% if task.task_definition.sections.any? %>
      <div class="task-section">
        <% task.task_definition.sections.each do |task_section| %>
          <% if task_section.introduction? %>
            <p>
              <%= task_section.introduction.html_safe %>
            </p>
          <% end %>
          <%= f.fields_for :section do |s| %>
            <%= s.fields_for "#{task_section.id}" do |section_number| %>
              <%= render "tasks/modules/#{task_section.module.code}",
                { task_form: f, section_form: section_number, task: task, task_section: task_section } %>
            <% end %>
          <% end %>
        <% end %>
    
        <!-- use progress bar if needed -->
        <div class="file-upload-progress invisible">
          <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
            <span class="sr-only">0% Complete</span>
          </div>
        </div>
      </div>
      <%= f.submit "Submit", class: 'button-primary' %>

    <% elsif task.user_confirm? %>
      <%= render 'tasks/subform_user_confirm', { f: f, task: task } %>
    <% end %>

  <% end %>
</div>